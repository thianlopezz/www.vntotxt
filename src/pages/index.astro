---
import { Image } from "astro:assets";
import VoiceChatPana from "../../public/voice-chat-pana.svg";
import SaveContactBro from "../../public/save-contact-bro.svg";
import ForwardMessageBro from "../../public/forward-message-bro.svg";
import TranscribedAudioBro from "../../public/transcribed-audio-bro.svg";
import Card from "../components/Card.astro";
import DescriptionDisplay from "../components/DescriptionDisplay.astro";
import NavigationLayout from "../layouts/NavigationLayout.astro";
import SubscriptionCardList from "../components/SubscriptionCardList.astro";
import { getLangFromUrl, useTranslations } from "../i18n/utils";
import FeaturePhone from "../components/FeaturePhone.astro";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<NavigationLayout language="en">
  <main class="md:flex md:h-screen mx-auto bg-secondary lg:px-36">
    <div
      id="hero-section"
      class="w-full md:w-1/2 p-10 flex flex-col justify-center"
    >
      <h1
        class="text-5xl sm:text-6xl mb-4 text-center md:text-left font-ubuntu font-bold"
      >
        {t("home.mainTitle.1")}
        <br />
        <span class="text-primary md:text-7xl">{t("home.mainTitle.2")}</span>
        <br />
        {t("home.mainTitle.3")} üîà
      </h1>
      <p class="my-5 text-center md:text-justify text-xl text-gray-800">
        {t("home.mainDescription")}
      </p>
      <div class="flex pt-3 md:pt-0">
        <a
          class="btn btn-primary btn-wide m-auto md:m-0"
          href="https://api.whatsapp.com/send?phone=17867444726"
          target="_blank"
          >{t("home.mainCallToAction")} <span class="text-xl">üòé</span></a
        >
      </div>
    </div>
    <!-- feature-image-container -->
    <div id="phone-section" class="flex py-10 md:w-1/2">
      <!-- class="feature-image-transition" -->
      <!-- <Image
          
          src={ImageBro1}
          alt="Voice note to text"
        /> -->
      <!-- class="feature-image-transition" -->
      <!-- <Image src={ImageBro2} alt="Voice note to text 2" /> -->
      <FeaturePhone />
    </div>
  </main>
  <section
    id="how-it-works"
    class="container flex-col content-center mx-auto pt-10 md:py-0"
  >
    <h2
      id="how-it-works-title"
      class="text-4xl text-center md:mb-5 md:mt-10 font-ubuntu font-bold"
    >
      {t("home.howItWorks.title")}
    </h2>
    <div class="px-5 md:px-10">
      <!-- bg-primary -->
      <div class="bg-neautral py-10 rounded-lg">
        <p id="how-it-works-subtitle" class="text-center mb-10">
          <span class="badge badge-primary badge-outline badge-lg">
            {t("home.howItWorks.subtitle")}</span
          >
        </p>
        <div
          class="flex flex-col md:flex-row justify-center justify-items-center"
        >
          <div
            id="hiw-step1"
            class="w-full md:w-1/3 flex flex-col items-center mb-6 md:mb-0 px-3"
          >
            <Card
              image={SaveContactBro}
              altImage={t("home.howItWorks.step-1.altImage")}
              number="1"
              title={t("home.howItWorks.step-1.title")}
              body={t("home.howItWorks.step-1.body")}
            >
              <a
                class="link link-primary"
                href="https://api.whatsapp.com/send?phone=17867444726"
                target="_blank">üá∫üá∏ +1 786 744 4726</a
              ></Card
            >
          </div>
          <div
            id="hiw-step2"
            class="w-full md:w-1/3 flex flex-col items-center mb-6 md:mb-0 px-3"
            style="animation-delay: .75s;"
          >
            <Card
              image={ForwardMessageBro}
              altImage={t("home.howItWorks.step-2.altImage")}
              number="2"
              title={t("home.howItWorks.step-2.title")}
              body={t("home.howItWorks.step-2.body")}
            />
          </div>
          <div
            id="hiw-step3"
            class="w-full md:w-1/3 flex flex-col items-center mb-6 md:mb-0 px-3"
            style="animation-delay: 1.5s;"
          >
            <Card
              image={TranscribedAudioBro}
              altImage={t("home.howItWorks.step-3.altImage")}
              number="3"
              title={t("home.howItWorks.step-3.title")}
              body={t("home.howItWorks.step-3.body")}
            />
          </div>
        </div>
      </div>
    </div>
  </section>
  <section
    id="features"
    class="md:h-screen bg-secondary flex flex-col justify-center items-center"
  >
    <h2
      id="features-title"
      class="text-4xl text-center md:text-center font-ubuntu font-bold pt-10 md:pt-0 px-5"
    >
      {t("home.features.title.1")}
      <br />
      <span class="text-primary text-4xl">{t("home.features.title.2")}</span> üìù
    </h2>
    <div id="features-body" class="flex flex-col-reverse md:flex-row">
      <div class="flex flex-col justify-center py-10 w-full md:w-5/12">
        <Image src={VoiceChatPana} alt="Voice note to text" loading="eager" />
      </div>
      <div class="w-full md:w-7/12 p-10 flex flex-col justify-center">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10 py-5">
          <DescriptionDisplay
            boxicon="bx bx-world"
            title={t("home.features.item.1.title")}
            descripton={t("home.features.item.1.description")}
          />
          <DescriptionDisplay
            boxicon="bx bxs-face"
            title={t("home.features.item.2.title")}
            descripton={t("home.features.item.2.description")}
          />
          <DescriptionDisplay
            boxicon="bx bx-search-alt"
            title={t("home.features.item.3.title")}
            descripton={t("home.features.item.3.description")}
          />
          <DescriptionDisplay
            boxicon="bx bxs-user-voice"
            title={t("home.features.item.4.title")}
            descripton={t("home.features.item.4.description")}
          />
        </div>
      </div>
    </div>
    <div id="features-call-to-action" class="flex py-3 md:py-5 w-full">
      <a
        class="btn btn-primary m-auto"
        href="https://api.whatsapp.com/send?phone=17867444726"
        >{t("home.features.callToAction")} <span class="text-xl">üòé</span></a
      >
    </div>
  </section>
  <section
    id="pricing"
    class="container flex-col content-center mx-auto pt-10 md:py-0"
  >
    <h2
      id="pricing-title"
      class="text-4xl text-center md:mb-5 md:mt-10 font-ubuntu font-bold"
    >
      {t("home.pricing.title")}
    </h2>
    <div id="pricing-body" class="px-5 md:px-10">
      <!-- bg-primary -->
      <div class="bg-neautral py-10 rounded-lg">
        <p class="text-center mb-10">
          <span class="badge badge-primary badge-outline badge-lg"
            >{t("home.pricing.subtitle")}</span
          >
        </p>
        <SubscriptionCardList />
      </div>
    </div>
  </section>
</NavigationLayout>

<style>
  .feature-image-container {
    position: relative;
  }

  .feature-image-transition {
    position: absolute;
    width: 100%;
    height: auto;
    animation: imageFade 7s infinite;
  }

  .feature-image-transition:nth-child(2) {
    animation-delay: 3.5s;
  }

  @keyframes imageFade {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0;
    }
  }

  #hero-section,
  #hero-section,
  #how-it-works-title,
  #how-it-works-subtitle,
  #features-title,
  #features-body,
  #features-call-to-action,
  #pricing-title,
  #pricing-body {
    opacity: 0;
    transform: translate3d(0, 20px, 0); /* Prepare for the slide-up effect */
  }

  #hiw-step1,
  #hiw-step2,
  #hiw-step3 {
    opacity: 0;
  }
</style>

<script is:inline>
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();

      document.querySelector(this.getAttribute("href")).scrollIntoView({
        behavior: "smooth",
      });
    });
  });

  document.addEventListener("DOMContentLoaded", () => {
    const observerFadeIn = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("animate-fadeInUp");
            observerFadeIn.unobserve(entry.target); // Optional: stop observing after animating
          }
        });
      },
      {
        root: null, // viewport is the default root
        threshold: 0.1, // Trigger when 10% of the target is visible
      },
    );

    // Target sections to observe
    const sectionsFadeIn = document.querySelectorAll(
      "#hero-section, #hero-section, #how-it-works-title, #how-it-works-subtitle, #features-title, #features-body, #features-call-to-action, #pricing-title, #pricing-body",
    );
    sectionsFadeIn.forEach((section) => observerFadeIn.observe(section));

    const observerPopup = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("animate-popup");
            observerPopup.unobserve(entry.target); // Optional: stop observing after animating
          }
        });
      },
      {
        root: null, // viewport is the default root
        threshold: 0.1, // Trigger when 10% of the target is visible
      },
    );

    // Target sections to observe
    const sectionsPopup = document.querySelectorAll(
      "#hiw-step1,#hiw-step2,#hiw-step3",
    );
    sectionsPopup.forEach((section) => observerPopup.observe(section));
  });
</script>
